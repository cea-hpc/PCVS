#!/bin/nawk -f
#
#  Specifically for sharedfp
#
#  To generate a binned distribution from the reformated data.
#
#  eg:  gnuplot> plot '< awkdistsfp -v B=1000 sharedfp.tmp1' 
#  B is the bin width in bytes

BEGIN {
	maxindex = 1;
}

	($1 ~ /##?/){
	print
}

	($1 !~ /##?/){
	i = 1 + int($1/B);
	if (i > maxindex) maxindex = i;
	temp = 0.0;
	if ($2 != 0.0) temp = $1/$2;	 
	a[i] ++ ;
	b[i] += temp;
}
        
END {
	for (i=1;i<maxindex + 2;i++){
	  temp = 0.0;
	  if (a[i] != 0.0) temp = b[i]/a[i];	  
	  printf "%f %f\n", (i-0.5)*B*1.0e-6, temp*1.0e-6;  
	}
} 



